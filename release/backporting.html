<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Backporting - Rust Forge</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Supplemental documentation for contributing to The Rust Programming Language">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust Forge</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/rust-lang/rust-forge" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/rust-lang/rust-forge/edit/master/src/release/backporting.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="backporting"><a class="header" href="#backporting">Backporting</a></h1>
<p>There’s a steady trickle of patches that need to be ported to the beta and stable branch.
Only a few people are even aware of the process, but this is actually something anybody can do.</p>
<h2 id="beta-backporting-in-rust-langrust"><a class="header" href="#beta-backporting-in-rust-langrust">Beta backporting in <code>rust-lang/rust</code></a></h2>
<p>Backports of PRs to the beta branch are usually only done to fix regressions.
Getting a PR backported to the beta branch involves the following process:</p>
<ol>
<li>
<p>Add the label <a href="https://github.com/rust-lang/rust/pulls?q=is%3Apr+label%3Abeta-nominated+-label%3Abeta-accepted"><code>beta-nominated</code></a> to the PR to be backported.
This marks the PR as in the state that it needs attention from the appropriate team to decide if it should be backported.
Anybody with triage access is free to add this label.</p>
</li>
<li>
<p>If the team thinks it should be backported, then they should add the <a href="https://github.com/rust-lang/rust/pulls?q=is%3Apr+label%3Abeta-accepted"><code>beta-accepted</code></a> label.
Otherwise they should remove the nominated label.</p>
</li>
<li>
<p>Occasionally someone will make a beta rollup PR.
This is often done by the release team, but it can be done by anyone.
The process here is:</p>
<ol>
<li>
<p>Create a local branch off the <code>beta</code> branch.</p>
</li>
<li>
<p>Cherry-pick all of the PRs that have both <a href="https://github.com/rust-lang/rust/pulls?q=is%3Apr+is%3Aclosed+label%3Abeta-accepted+label%3Abeta-nominated"><code>beta-nominated</code> and <code>beta-accepted</code></a> labels.
It is usually preferred to not include PRs that have not been merged in case there are any last minute changes, or it fails when running the full CI tests.</p>
</li>
<li>
<p>Run <code>./x.py run replace-version-placeholder</code> and if there were any changes, put them into a new commit.</p>
</li>
<li>
<p>(Recommended) Run some tests locally.
It is not uncommon that the backports may not apply cleanly, or the UI tests need to be re-blessed if there are differences in the output.</p>
</li>
<li>
<p>Open a PR <strong>against the beta branch</strong> with a title that starts with <code>[beta]</code> (so reviewers can see its specialness).</p>
</li>
<li>
<p>List all of the PRs being backported in the PR description.
<a href="https://github.com/rust-lang/rust/pull/64097">Here’s an example</a>.</p>
</li>
<li>
<p>Go through all of the PRs being backported and:</p>
<ul>
<li>Change the milestone to the correct value for the beta release.</li>
<li>Remove the <code>beta-nominated</code> label.
This indicates that the backport has been completed.</li>
</ul>
<p>If there are a lot of PRs, this can be done quickly by opening the <a href="https://github.com/rust-lang/rust/pulls?q=is%3Apr+is%3Aclosed+label%3Abeta-accepted+label%3Abeta-nominated">nominated + accepted</a> query, check all the PRs being backported, and use the “Milestones” and “Label” drop-downs to modify multiple PRs in bulk.</p>
<p>This last step can be done before or after the beta PR has been merged, though it can be easy to forget if you wait for it to be merged.</p>
</li>
</ol>
</li>
<li>
<p>A reviewer (typically from the release team) needs to verify that the backport looks correct and that it’s submitted to the beta branch.
They will then approve with <code>@bors r+ rollup=never</code> (to avoid it being rolled up on accident).
If the author of the PR has r+ rights, and has not made significant changes while backporting, they can also self-approve the PR.</p>
</li>
</ol>
<p>In summary, there are three states that a PR can go through:</p>
<ol>
<li><code>beta-nominated</code>: Needs the team’s attention.</li>
<li><code>beta-nominated</code> + <code>beta-accepted</code>: Waiting to be backported.</li>
<li><code>beta-accepted</code>: Backport complete.</li>
</ol>
<h2 id="stable-backporting-in-rust-langrust"><a class="header" href="#stable-backporting-in-rust-langrust">Stable backporting in <code>rust-lang/rust</code></a></h2>
<p>Backports to the stable branch work exactly the same as beta ones, labels have
just a slightly different name: <code>stable-nominated</code> identifies a PR to be
discussed for a backport and <code>stable-accepted</code> is a PR accepted for
backport. Declined stable nomination will have the <code>stable-nominated</code> label
removed.</p>
<p>The <code>T-release</code> will decide on a case by case basis if a stable backport will
warrant a point (.patch) release (f.e. release a <code>1.50.1</code> between <code>1.50</code> and <code>1.51</code>).</p>
<h2 id="beta-backporting-in-rust-langcargo"><a class="header" href="#beta-backporting-in-rust-langcargo">Beta Backporting in <code>rust-lang/cargo</code></a></h2>
<p>The procedure for backporting fixes to Cargo is similar but slightly more
extended than the <code>rust-lang/rust</code> repo’s procedure. Currently there aren’t
backport tags in the Cargo repository, but you’ll initiate the backport process
by commenting on an associated PR, requesting a backport. Once a Cargo team
member has approved the backport to happen you’re good to start sending PRs!</p>
<ul>
<li>
<p>First you’ll send a PR to the <code>rust-1.21.0</code> branch of Cargo (replace 1.21 with
the current rustc beta version number). Like with <code>rust-lang/rust</code> you’ll
prefix the title of your PR with <code>[beta]</code> and ensure it’s flagged as going to
beta.</p>
</li>
<li>
<p>Next a Cargo reviewer will <code>@bors: r+</code> the PR and put it into the queue.
Eventually bors will automatically merge the PR (when tests are passing) to
the appropriate Cargo branch.</p>
</li>
<li>
<p>Finally you’ll send a PR to the <code>rust-lang/rust</code> repository’s <code>beta</code> branch,
updating the Cargo submodule. The Cargo submodule should be updated to the tip
of the <code>rust-1.21.0</code> branch (the branch your Cargo PR was merged to). As like
before, ensure you’ve got <code>[beta]</code> in the PR title.</p>
</li>
</ul>
<p>After that’s all said and done the Cargo change is ready to get scheduled onto
the beta release!</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../release/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../release/release-notes.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../release/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../release/release-notes.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../js/moment.min.js"></script>
        <script src="../js/index.js"></script>


    </div>
    </body>
</html>
