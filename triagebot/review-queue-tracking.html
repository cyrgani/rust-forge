<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Review queue tracking - Rust Forge</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Supplemental documentation for contributing to The Rust Programming Language">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust Forge</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/rust-lang/rust-forge" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/rust-lang/rust-forge/edit/master/src/triagebot/review-queue-tracking.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="review-queue-tracking"><a class="header" href="#review-queue-tracking">Review queue tracking</a></h1>
<p>Triagebot supports more advanced tracking of reviewers’ workload in the <code>rust-lang/rust</code> repository. It tracks how many “relevant” pull requests are assigned to each reviewer, and allows reviewers to configure maximum capacity of such PRs, and also if they want to be automatically assigned or not.</p>
<p>This page describes how the review queue works and how you can interact with <code>triagebot</code> on Zulip to configure and examine the review queue.</p>
<h2 id="configuration"><a class="header" href="#configuration">Configuration</a></h2>
<p>To enable review queue tracking for a repository, include <code>[pr-tracking]</code> table in its <code>triagebot.toml</code>.</p>
<p>To take the review queue into account when assigning reviewers on PRs, add a <code>[assign.review_prefs]</code> table to <code>triagebot.toml</code>.</p>
<blockquote>
<p>Note that this functionality currently only works for the <code>rust-lang/rust</code> repository (it is hardcoded in <code>triagebot</code>). Enabling it for more repositories requires additional design and implementation work.</p>
</blockquote>
<h2 id="review-queue-design"><a class="header" href="#review-queue-design">Review queue design</a></h2>
<p>The review queue remembers how many “relevant” <code>rust-lang/rust</code> PRs are assigned to each reviewer at any given point in time.
Currently, the heuristic for what makes a PR “relevant” works as follows:</p>
<ul>
<li>The PR must not be blocked (it must not have the <code>S-blocked</code> or <code>S-inactive</code> labels).</li>
<li>The PR must not be a rollup.</li>
<li>The PR must be waiting for a reviewer (must have the <code>S-waiting-on-review</code> label).</li>
<li>The PR must be assigned to someone else than the PR author.</li>
<li>The PR must be open and not a draft.</li>
</ul>
<p>If a PR passes all these checks and it is assigned to reviewer <code>R</code>, it will be considered to be in <code>R</code>’s review queue.</p>
<p>See the implementation of the <a href="https://github.com/rust-lang/triagebot/blob/7044e5449aaf29eea939bc7db81c63b7c872b9b8/src/handlers/pr_tracking.rs#L277-L304"><code>waits_for_a_review</code></a> function in triagebot for more details.</p>
<h2 id="review-preferences"><a class="header" href="#review-preferences">Review preferences</a></h2>
<p>Reviewers can configure <em>review preferences</em> that are taken into account when determining who to assign on a PR:</p>
<ul>
<li>Review queue capacity (<code>C</code>) — if the number of PRs in your review queue is at (or above) <code>C</code>, <code>triagebot</code> will not assign new pull requests to you.</li>
<li>Rotation mode (<code>on</code> or <code>off</code> rotation) — if you set your rotation mode to be <code>off</code>, <code>triagebot</code> will not assign new pull requests to you.
<ul>
<li>This is an alternative to setting yourself as being <a href="pr-assignment.html#vacation">“on vacation”</a> which does not require sending a pull request to modify the <code>triagebot.toml</code> file. <code>triagebot</code> takes both <code>users_on_vacation</code> in <code>triagebot.toml</code> and the rotation mode into account; if you are marked as being on vacation in either of them, it will not assign PRs to you.</li>
</ul>
</li>
</ul>
<p>Note that the review preferences only affect assignment based on adhoc groups or teams. If someone directly requests your review (<code>r? &lt;user&gt;</code>), triagebot will currently always assign you. If you are off rotation or at your maximum review capacity, triagebot will send a comment to the PR where you were directly assigned to let the PR author know that you might not be available for a timely review.</p>
<h2 id="usage"><a class="header" href="#usage">Usage</a></h2>
<p>You can examine your review queue and configure your review preferences by sending a DM (Direct Message) to the <code>triagebot</code> bot account on the <a href="../platforms/zulip.html">Zulip chat</a>. You can open a DM session with the <code>triagebot</code> bot by clicking on <a href="https://rust-lang.zulipchat.com/#narrow/dm/261224-triagebot">this link</a> (requires Zulip login).</p>
<p>You can send a message with one of these commands to <code>triagebot</code>:</p>
<ul>
<li><code>work help</code> — Show the available commands.</li>
<li><code>work show</code> — Show the contents of your review queue (in the <code>rust-lang/rust</code> repository) and your review preferences.</li>
<li><code>work set-pr-limit &lt;number&gt;|unlimited</code> — Set your review capacity to <code>&lt;number&gt;</code> or remove the capacity limit (<code>unlimited</code>).</li>
<li><code>work set-rotation-mode off|on</code> — Set your rotation mode to be <code>on</code> or <code>off</code>.</li>
</ul>
<p>You can also run the above commands on behalf of other GitHub users with the following message:</p>
<pre><code>as &lt;github-username&gt; &lt;command&gt;
# e.g.
as MyFavouriteGitHubUser work show
</code></pre>
<p><code>triagebot</code> will notify the user that you have executed a command on their behalf. Note that this functionality is intended for rare occasions or debugging, please do not use it often.</p>
<h2 id="implementation"><a class="header" href="#implementation">Implementation</a></h2>
<p>See <a href="https://github.com/rust-lang/triagebot/blob/HEAD/src/handlers/pr_tracking.rs"><code>src/handlers/pr_tracking.rs</code></a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../triagebot/pr-assignment.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../triagebot/autolabels.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../triagebot/pr-assignment.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../triagebot/autolabels.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../js/moment.min.js"></script>
        <script src="../js/index.js"></script>


    </div>
    </body>
</html>
